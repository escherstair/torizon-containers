# Copyright (c) 2019-2024 Toradex AG
# SPDX-License-Identifier: MIT

ARG BASE_IMAGE_NAME
ARG DOTNET_DEBUGGER_VER
ARG IMAGE_TAG
ARG REGISTRY
ARG REGISTRY_NAMESPACE

FROM $REGISTRY/$REGISTRY_NAMESPACE/$BASE_IMAGE_NAME:$IMAGE_TAG AS build

ARG DOTNET_DEBUGGER_VER

RUN test -n "$DOTNET_DEBUGGER_VER" || (echo "DOTNET_DEBUGGER_VER  not set" && false)

RUN wget -O- https://aka.ms/getvsdbgsh \
    | /bin/sh /dev/stdin -v ${DOTNET_DEBUGGER_VER} -l /vsdbg

FROM $REGISTRY/$REGISTRY_NAMESPACE/$BASE_IMAGE_NAME:$IMAGE_TAG

COPY --from=build /vsdbg /vsdbg
